{"ast":null,"code":"import _toConsumableArray from \"D:/MyFile/WebCode/ocean-vis/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport _defineProperty from \"D:/MyFile/WebCode/ocean-vis/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nimport \"core-js/modules/es.number.constructor.js\";\nimport \"core-js/modules/es.array.includes.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.string.includes.js\";\nimport \"core-js/modules/es.array.from.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport { defineComponent, inject, ref, computed, watch, onMounted, onUpdated, h } from 'vue';\nimport { NOOP, capitalize } from '@vue/shared';\nimport { useDocumentVisibility, useWindowFocus, useResizeObserver } from '@vueuse/core';\nimport '../../../utils/index.mjs';\nimport '../../../constants/index.mjs';\nimport { ElIcon } from '../../icon/index.mjs';\nimport { ArrowLeft, ArrowRight, Close } from '@element-plus/icons-vue';\nimport '../../../tokens/index.mjs';\nimport TabBar from './tab-bar2.mjs';\nimport { buildProps, definePropType } from '../../../utils/vue/props.mjs';\nimport { mutable } from '../../../utils/typescript.mjs';\nimport { tabsRootContextKey } from '../../../tokens/tabs.mjs';\nimport { throwError } from '../../../utils/error.mjs';\nimport { EVENT_CODE } from '../../../constants/aria.mjs';\nvar tabNavProps = buildProps({\n  panes: {\n    type: definePropType(Array),\n    default: function _default() {\n      return mutable([]);\n    }\n  },\n  currentName: {\n    type: [String, Number],\n    default: \"\"\n  },\n  editable: Boolean,\n  onTabClick: {\n    type: definePropType(Function),\n    default: NOOP\n  },\n  onTabRemove: {\n    type: definePropType(Function),\n    default: NOOP\n  },\n  type: {\n    type: String,\n    values: [\"card\", \"border-card\", \"\"],\n    default: \"\"\n  },\n  stretch: Boolean\n});\nvar COMPONENT_NAME = \"ElTabNav\";\nvar TabNav = defineComponent({\n  name: COMPONENT_NAME,\n  props: tabNavProps,\n  setup: function setup(props, _ref) {\n    var expose = _ref.expose;\n    var visibility = useDocumentVisibility();\n    var focused = useWindowFocus();\n    var rootTabs = inject(tabsRootContextKey);\n    if (!rootTabs) throwError(COMPONENT_NAME, \"ElTabNav must be nested inside ElTabs\");\n    var scrollable = ref(false);\n    var navOffset = ref(0);\n    var isFocus = ref(false);\n    var focusable = ref(true);\n    var navScroll$ = ref();\n    var nav$ = ref();\n    var el$ = ref();\n    var sizeName = computed(function () {\n      return [\"top\", \"bottom\"].includes(rootTabs.props.tabPosition) ? \"width\" : \"height\";\n    });\n    var navStyle = computed(function () {\n      var dir = sizeName.value === \"width\" ? \"X\" : \"Y\";\n      return {\n        transform: \"translate\".concat(dir, \"(-\").concat(navOffset.value, \"px)\")\n      };\n    });\n\n    var scrollPrev = function scrollPrev() {\n      if (!navScroll$.value) return;\n      var containerSize = navScroll$.value[\"offset\".concat(capitalize(sizeName.value))];\n      var currentOffset = navOffset.value;\n      if (!currentOffset) return;\n      var newOffset = currentOffset > containerSize ? currentOffset - containerSize : 0;\n      navOffset.value = newOffset;\n    };\n\n    var scrollNext = function scrollNext() {\n      if (!navScroll$.value || !nav$.value) return;\n      var navSize = nav$.value[\"offset\".concat(capitalize(sizeName.value))];\n      var containerSize = navScroll$.value[\"offset\".concat(capitalize(sizeName.value))];\n      var currentOffset = navOffset.value;\n      if (navSize - currentOffset <= containerSize) return;\n      var newOffset = navSize - currentOffset > containerSize * 2 ? currentOffset + containerSize : navSize - containerSize;\n      navOffset.value = newOffset;\n    };\n\n    var scrollToActiveTab = function scrollToActiveTab() {\n      var nav = nav$.value;\n      if (!scrollable.value || !el$.value || !navScroll$.value || !nav) return;\n      var activeTab = el$.value.querySelector(\".is-active\");\n      if (!activeTab) return;\n      var navScroll = navScroll$.value;\n      var isHorizontal = [\"top\", \"bottom\"].includes(rootTabs.props.tabPosition);\n      var activeTabBounding = activeTab.getBoundingClientRect();\n      var navScrollBounding = navScroll.getBoundingClientRect();\n      var maxOffset = isHorizontal ? nav.offsetWidth - navScrollBounding.width : nav.offsetHeight - navScrollBounding.height;\n      var currentOffset = navOffset.value;\n      var newOffset = currentOffset;\n\n      if (isHorizontal) {\n        if (activeTabBounding.left < navScrollBounding.left) {\n          newOffset = currentOffset - (navScrollBounding.left - activeTabBounding.left);\n        }\n\n        if (activeTabBounding.right > navScrollBounding.right) {\n          newOffset = currentOffset + activeTabBounding.right - navScrollBounding.right;\n        }\n      } else {\n        if (activeTabBounding.top < navScrollBounding.top) {\n          newOffset = currentOffset - (navScrollBounding.top - activeTabBounding.top);\n        }\n\n        if (activeTabBounding.bottom > navScrollBounding.bottom) {\n          newOffset = currentOffset + (activeTabBounding.bottom - navScrollBounding.bottom);\n        }\n      }\n\n      newOffset = Math.max(newOffset, 0);\n      navOffset.value = Math.min(newOffset, maxOffset);\n    };\n\n    var update = function update() {\n      if (!nav$.value || !navScroll$.value) return;\n      var navSize = nav$.value[\"offset\".concat(capitalize(sizeName.value))];\n      var containerSize = navScroll$.value[\"offset\".concat(capitalize(sizeName.value))];\n      var currentOffset = navOffset.value;\n\n      if (containerSize < navSize) {\n        var currentOffset2 = navOffset.value;\n        scrollable.value = scrollable.value || {};\n        scrollable.value.prev = currentOffset2;\n        scrollable.value.next = currentOffset2 + containerSize < navSize;\n\n        if (navSize - currentOffset2 < containerSize) {\n          navOffset.value = navSize - containerSize;\n        }\n      } else {\n        scrollable.value = false;\n\n        if (currentOffset > 0) {\n          navOffset.value = 0;\n        }\n      }\n    };\n\n    var changeTab = function changeTab(e) {\n      var code = e.code;\n      var up = EVENT_CODE.up,\n          down = EVENT_CODE.down,\n          left = EVENT_CODE.left,\n          right = EVENT_CODE.right;\n      if (![up, down, left, right].includes(code)) return;\n      var tabList = Array.from(e.currentTarget.querySelectorAll(\"[role=tab]\"));\n      var currentIndex = tabList.indexOf(e.target);\n      var nextIndex;\n\n      if (code === left || code === up) {\n        if (currentIndex === 0) {\n          nextIndex = tabList.length - 1;\n        } else {\n          nextIndex = currentIndex - 1;\n        }\n      } else {\n        if (currentIndex < tabList.length - 1) {\n          nextIndex = currentIndex + 1;\n        } else {\n          nextIndex = 0;\n        }\n      }\n\n      tabList[nextIndex].focus();\n      tabList[nextIndex].click();\n      setFocus();\n    };\n\n    var setFocus = function setFocus() {\n      if (focusable.value) isFocus.value = true;\n    };\n\n    var removeFocus = function removeFocus() {\n      return isFocus.value = false;\n    };\n\n    watch(visibility, function (visibility2) {\n      if (visibility2 === \"hidden\") {\n        focusable.value = false;\n      } else if (visibility2 === \"visible\") {\n        setTimeout(function () {\n          return focusable.value = true;\n        }, 50);\n      }\n    });\n    watch(focused, function (focused2) {\n      if (focused2) {\n        setTimeout(function () {\n          return focusable.value = true;\n        }, 50);\n      } else {\n        focusable.value = false;\n      }\n    });\n    useResizeObserver(el$, update);\n    onMounted(function () {\n      return setTimeout(function () {\n        return scrollToActiveTab();\n      }, 0);\n    });\n    onUpdated(function () {\n      return update();\n    });\n    expose({\n      scrollToActiveTab: scrollToActiveTab,\n      removeFocus: removeFocus\n    });\n    return function () {\n      var scrollBtn = scrollable.value ? [h(\"span\", {\n        class: [\"el-tabs__nav-prev\", scrollable.value.prev ? \"\" : \"is-disabled\"],\n        onClick: scrollPrev\n      }, [h(ElIcon, {}, {\n        default: function _default() {\n          return h(ArrowLeft);\n        }\n      })]), h(\"span\", {\n        class: [\"el-tabs__nav-next\", scrollable.value.next ? \"\" : \"is-disabled\"],\n        onClick: scrollNext\n      }, [h(ElIcon, {}, {\n        default: function _default() {\n          return h(ArrowRight);\n        }\n      })])] : null;\n      var tabs = props.panes.map(function (pane, index) {\n        var _class;\n\n        var _a, _b;\n\n        var tabName = pane.props.name || pane.index || \"\".concat(index);\n        var closable = pane.isClosable || props.editable;\n        pane.index = \"\".concat(index);\n        var btnClose = closable ? h(ElIcon, {\n          class: \"is-icon-close\",\n          onClick: function onClick(ev) {\n            return props.onTabRemove(pane, ev);\n          }\n        }, {\n          default: function _default() {\n            return h(Close);\n          }\n        }) : null;\n        var tabLabelContent = ((_b = (_a = pane.instance.slots).label) == null ? void 0 : _b.call(_a)) || pane.props.label;\n        var tabindex = pane.active ? 0 : -1;\n        return h(\"div\", {\n          class: (_class = {\n            \"el-tabs__item\": true\n          }, _defineProperty(_class, \"is-\".concat(rootTabs.props.tabPosition), true), _defineProperty(_class, \"is-active\", pane.active), _defineProperty(_class, \"is-disabled\", pane.props.disabled), _defineProperty(_class, \"is-closable\", closable), _defineProperty(_class, \"is-focus\", isFocus), _class),\n          id: \"tab-\".concat(tabName),\n          key: \"tab-\".concat(tabName),\n          \"aria-controls\": \"pane-\".concat(tabName),\n          role: \"tab\",\n          \"aria-selected\": pane.active,\n          ref: \"tab-\".concat(tabName),\n          tabindex: tabindex,\n          onFocus: function onFocus() {\n            return setFocus();\n          },\n          onBlur: function onBlur() {\n            return removeFocus();\n          },\n          onClick: function onClick(ev) {\n            removeFocus();\n            props.onTabClick(pane, tabName, ev);\n          },\n          onKeydown: function onKeydown(ev) {\n            if (closable && (ev.code === EVENT_CODE.delete || ev.code === EVENT_CODE.backspace)) {\n              props.onTabRemove(pane, ev);\n            }\n          }\n        }, [tabLabelContent, btnClose]);\n      });\n      return h(\"div\", {\n        ref: el$,\n        class: [\"el-tabs__nav-wrap\", scrollable.value ? \"is-scrollable\" : \"\", \"is-\".concat(rootTabs.props.tabPosition)]\n      }, [scrollBtn, h(\"div\", {\n        class: \"el-tabs__nav-scroll\",\n        ref: navScroll$\n      }, [h(\"div\", {\n        class: [\"el-tabs__nav\", \"is-\".concat(rootTabs.props.tabPosition), props.stretch && [\"top\", \"bottom\"].includes(rootTabs.props.tabPosition) ? \"is-stretch\" : \"\"],\n        ref: nav$,\n        style: navStyle.value,\n        role: \"tablist\",\n        onKeydown: changeTab\n      }, [!props.type ? h(TabBar, {\n        tabs: _toConsumableArray(props.panes)\n      }) : null, tabs])])]);\n    };\n  }\n});\nexport { TabNav as default, tabNavProps };","map":{"version":3,"mappings":"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","names":["tabNavProps","buildProps","panes","type","definePropType","Array","default","mutable","currentName","String","Number","editable","Boolean","onTabClick","Function","NOOP","onTabRemove","values","stretch","COMPONENT_NAME","defineComponent","name","props","setup","expose","visibility","useDocumentVisibility","focused","useWindowFocus","rootTabs","inject","tabsRootContextKey","throwError","scrollable","ref","navOffset","isFocus","focusable","navScroll$","nav$","el$","sizeName","computed","includes","tabPosition","navStyle","dir","value","transform","scrollPrev","containerSize","capitalize","currentOffset","newOffset","scrollNext","navSize","scrollToActiveTab","nav","activeTab","querySelector","navScroll","isHorizontal","activeTabBounding","getBoundingClientRect","navScrollBounding","maxOffset","offsetWidth","width","offsetHeight","height","left","right","top","bottom","Math","max","min","update","currentOffset2","prev","next","changeTab","e","code","up","EVENT_CODE","down","tabList","from","currentTarget","querySelectorAll","currentIndex","indexOf","target","nextIndex","length","focus","click","setFocus","removeFocus","watch","visibility2","setTimeout","focused2","useResizeObserver","onMounted","onUpdated","scrollBtn","h","class","onClick","ElIcon","ArrowLeft","ArrowRight","tabs","map","pane","index","_a","_b","tabName","closable","isClosable","btnClose","ev","Close","tabLabelContent","instance","slots","label","call","tabindex","active","disabled","id","key","role","onFocus","onBlur","onKeydown","delete","backspace","style","TabBar"],"sources":["../../../../../../packages/components/tabs/src/tab-nav.ts"],"sourcesContent":["import {\n  h,\n  defineComponent,\n  ref,\n  inject,\n  computed,\n  onUpdated,\n  onMounted,\n  watch,\n} from 'vue'\nimport { NOOP, capitalize } from '@vue/shared'\nimport {\n  useResizeObserver,\n  useDocumentVisibility,\n  useWindowFocus,\n} from '@vueuse/core'\nimport {\n  buildProps,\n  definePropType,\n  mutable,\n  throwError,\n} from '@element-plus/utils'\nimport { EVENT_CODE } from '@element-plus/constants'\nimport { ElIcon } from '@element-plus/components/icon'\nimport { ArrowLeft, ArrowRight, Close } from '@element-plus/icons-vue'\nimport { tabsRootContextKey } from '@element-plus/tokens'\nimport TabBar from './tab-bar.vue'\nimport type { ExtractPropTypes, CSSProperties } from 'vue'\nimport type { TabsPaneContext } from '@element-plus/tokens'\nexport interface Scrollable {\n  next?: boolean\n  prev?: number\n}\n\nexport const tabNavProps = buildProps({\n  panes: {\n    type: definePropType<TabsPaneContext[]>(Array),\n    default: () => mutable([] as const),\n  },\n  currentName: {\n    type: [String, Number],\n    default: '',\n  },\n  editable: Boolean,\n  onTabClick: {\n    type: definePropType<\n      (tab: TabsPaneContext, tabName: string | number, ev: Event) => void\n    >(Function),\n    default: NOOP,\n  },\n  onTabRemove: {\n    type: definePropType<(tab: TabsPaneContext, ev: Event) => void>(Function),\n    default: NOOP,\n  },\n  type: {\n    type: String,\n    values: ['card', 'border-card', ''],\n    default: '',\n  },\n  stretch: Boolean,\n} as const)\n\nexport type TabNavProps = ExtractPropTypes<typeof tabNavProps>\n\nconst COMPONENT_NAME = 'ElTabNav'\nexport default defineComponent({\n  name: COMPONENT_NAME,\n  props: tabNavProps,\n\n  setup(props, { expose }) {\n    const visibility = useDocumentVisibility()\n    const focused = useWindowFocus()\n\n    const rootTabs = inject(tabsRootContextKey)\n    if (!rootTabs)\n      throwError(COMPONENT_NAME, `ElTabNav must be nested inside ElTabs`)\n\n    const scrollable = ref<false | Scrollable>(false)\n    const navOffset = ref(0)\n    const isFocus = ref(false)\n    const focusable = ref(true)\n\n    const navScroll$ = ref<HTMLDivElement>()\n    const nav$ = ref<HTMLDivElement>()\n    const el$ = ref<HTMLDivElement>()\n\n    const sizeName = computed(() =>\n      ['top', 'bottom'].includes(rootTabs.props.tabPosition)\n        ? 'width'\n        : 'height'\n    )\n    const navStyle = computed<CSSProperties>(() => {\n      const dir = sizeName.value === 'width' ? 'X' : 'Y'\n      return {\n        transform: `translate${dir}(-${navOffset.value}px)`,\n      }\n    })\n\n    const scrollPrev = () => {\n      if (!navScroll$.value) return\n\n      const containerSize =\n        navScroll$.value[`offset${capitalize(sizeName.value)}`]\n      const currentOffset = navOffset.value\n\n      if (!currentOffset) return\n\n      const newOffset =\n        currentOffset > containerSize ? currentOffset - containerSize : 0\n\n      navOffset.value = newOffset\n    }\n\n    const scrollNext = () => {\n      if (!navScroll$.value || !nav$.value) return\n\n      const navSize = nav$.value[`offset${capitalize(sizeName.value)}`]\n      const containerSize =\n        navScroll$.value[`offset${capitalize(sizeName.value)}`]\n      const currentOffset = navOffset.value\n\n      if (navSize - currentOffset <= containerSize) return\n\n      const newOffset =\n        navSize - currentOffset > containerSize * 2\n          ? currentOffset + containerSize\n          : navSize - containerSize\n\n      navOffset.value = newOffset\n    }\n\n    const scrollToActiveTab = () => {\n      const nav = nav$.value\n      if (!scrollable.value || !el$.value || !navScroll$.value || !nav) return\n\n      const activeTab = el$.value.querySelector('.is-active')\n      if (!activeTab) return\n\n      const navScroll = navScroll$.value\n      const isHorizontal = ['top', 'bottom'].includes(\n        rootTabs.props.tabPosition\n      )\n      const activeTabBounding = activeTab.getBoundingClientRect()\n      const navScrollBounding = navScroll.getBoundingClientRect()\n      const maxOffset = isHorizontal\n        ? nav.offsetWidth - navScrollBounding.width\n        : nav.offsetHeight - navScrollBounding.height\n      const currentOffset = navOffset.value\n      let newOffset = currentOffset\n\n      if (isHorizontal) {\n        if (activeTabBounding.left < navScrollBounding.left) {\n          newOffset =\n            currentOffset - (navScrollBounding.left - activeTabBounding.left)\n        }\n        if (activeTabBounding.right > navScrollBounding.right) {\n          newOffset =\n            currentOffset + activeTabBounding.right - navScrollBounding.right\n        }\n      } else {\n        if (activeTabBounding.top < navScrollBounding.top) {\n          newOffset =\n            currentOffset - (navScrollBounding.top - activeTabBounding.top)\n        }\n        if (activeTabBounding.bottom > navScrollBounding.bottom) {\n          newOffset =\n            currentOffset +\n            (activeTabBounding.bottom - navScrollBounding.bottom)\n        }\n      }\n      newOffset = Math.max(newOffset, 0)\n      navOffset.value = Math.min(newOffset, maxOffset)\n    }\n\n    const update = () => {\n      if (!nav$.value || !navScroll$.value) return\n\n      const navSize = nav$.value[`offset${capitalize(sizeName.value)}`]\n      const containerSize =\n        navScroll$.value[`offset${capitalize(sizeName.value)}`]\n      const currentOffset = navOffset.value\n\n      if (containerSize < navSize) {\n        const currentOffset = navOffset.value\n        scrollable.value = scrollable.value || {}\n        scrollable.value.prev = currentOffset\n        scrollable.value.next = currentOffset + containerSize < navSize\n        if (navSize - currentOffset < containerSize) {\n          navOffset.value = navSize - containerSize\n        }\n      } else {\n        scrollable.value = false\n        if (currentOffset > 0) {\n          navOffset.value = 0\n        }\n      }\n    }\n\n    const changeTab = (e: KeyboardEvent) => {\n      const code = e.code\n\n      const { up, down, left, right } = EVENT_CODE\n      if (![up, down, left, right].includes(code)) return\n\n      // 左右上下键更换tab\n      const tabList = Array.from(\n        (e.currentTarget as HTMLDivElement).querySelectorAll<HTMLDivElement>(\n          '[role=tab]'\n        )\n      )\n      const currentIndex = tabList.indexOf(e.target as HTMLDivElement)\n\n      let nextIndex: number\n      if (code === left || code === up) {\n        // left\n        if (currentIndex === 0) {\n          // first\n          nextIndex = tabList.length - 1\n        } else {\n          nextIndex = currentIndex - 1\n        }\n      } else {\n        // right\n        if (currentIndex < tabList.length - 1) {\n          // not last\n          nextIndex = currentIndex + 1\n        } else {\n          nextIndex = 0\n        }\n      }\n      tabList[nextIndex].focus() // 改变焦点元素\n      tabList[nextIndex].click() // 选中下一个tab\n      setFocus()\n    }\n\n    const setFocus = () => {\n      if (focusable.value) isFocus.value = true\n    }\n    const removeFocus = () => (isFocus.value = false)\n\n    watch(visibility, (visibility) => {\n      if (visibility === 'hidden') {\n        focusable.value = false\n      } else if (visibility === 'visible') {\n        setTimeout(() => (focusable.value = true), 50)\n      }\n    })\n    watch(focused, (focused) => {\n      if (focused) {\n        setTimeout(() => (focusable.value = true), 50)\n      } else {\n        focusable.value = false\n      }\n    })\n\n    useResizeObserver(el$, update)\n\n    onMounted(() => setTimeout(() => scrollToActiveTab(), 0))\n    onUpdated(() => update())\n\n    expose({\n      scrollToActiveTab,\n      removeFocus,\n    })\n\n    return () => {\n      const scrollBtn = scrollable.value\n        ? [\n            h(\n              'span',\n              {\n                class: [\n                  'el-tabs__nav-prev',\n                  scrollable.value.prev ? '' : 'is-disabled',\n                ],\n                onClick: scrollPrev,\n              },\n              [h(ElIcon, {}, { default: () => h(ArrowLeft) })]\n            ),\n            h(\n              'span',\n              {\n                class: [\n                  'el-tabs__nav-next',\n                  scrollable.value.next ? '' : 'is-disabled',\n                ],\n                onClick: scrollNext,\n              },\n              [h(ElIcon, {}, { default: () => h(ArrowRight) })]\n            ),\n          ]\n        : null\n\n      const tabs = props.panes.map((pane, index) => {\n        const tabName = pane.props.name || pane.index || `${index}`\n        const closable = pane.isClosable || props.editable\n        pane.index = `${index}`\n\n        const btnClose = closable\n          ? h(\n              ElIcon,\n              {\n                class: 'is-icon-close',\n                onClick: (ev: MouseEvent) => props.onTabRemove(pane, ev),\n              },\n              { default: () => h(Close) }\n            )\n          : null\n\n        const tabLabelContent =\n          pane.instance.slots.label?.() || pane.props.label\n        const tabindex = pane.active ? 0 : -1\n\n        return h(\n          'div',\n          {\n            class: {\n              'el-tabs__item': true,\n              [`is-${rootTabs.props.tabPosition}`]: true,\n              'is-active': pane.active,\n              'is-disabled': pane.props.disabled,\n              'is-closable': closable,\n              'is-focus': isFocus,\n            },\n            id: `tab-${tabName}`,\n            key: `tab-${tabName}`,\n            'aria-controls': `pane-${tabName}`,\n            role: 'tab',\n            'aria-selected': pane.active,\n            ref: `tab-${tabName}`,\n            tabindex,\n            onFocus: () => setFocus(),\n            onBlur: () => removeFocus(),\n            onClick: (ev: MouseEvent) => {\n              removeFocus()\n              props.onTabClick(pane, tabName, ev)\n            },\n            onKeydown: (ev: KeyboardEvent) => {\n              if (\n                closable &&\n                (ev.code === EVENT_CODE.delete ||\n                  ev.code === EVENT_CODE.backspace)\n              ) {\n                props.onTabRemove(pane, ev)\n              }\n            },\n          },\n          [tabLabelContent, btnClose]\n        )\n      })\n\n      return h(\n        'div',\n        {\n          ref: el$,\n          class: [\n            'el-tabs__nav-wrap',\n            scrollable.value ? 'is-scrollable' : '',\n            `is-${rootTabs.props.tabPosition}`,\n          ],\n        },\n        [\n          scrollBtn,\n          h(\n            'div',\n            {\n              class: 'el-tabs__nav-scroll',\n              ref: navScroll$,\n            },\n            [\n              h(\n                'div',\n                {\n                  class: [\n                    'el-tabs__nav',\n                    `is-${rootTabs.props.tabPosition}`,\n                    props.stretch &&\n                    ['top', 'bottom'].includes(rootTabs.props.tabPosition)\n                      ? 'is-stretch'\n                      : '',\n                  ],\n                  ref: nav$,\n                  style: navStyle.value,\n                  role: 'tablist',\n                  onKeydown: changeTab,\n                },\n                [\n                  !props.type\n                    ? h(TabBar, {\n                        tabs: [...props.panes],\n                      })\n                    : null,\n                  tabs,\n                ]\n              ),\n            ]\n          ),\n        ]\n      )\n    }\n  },\n})\n"]},"metadata":{},"sourceType":"module"}