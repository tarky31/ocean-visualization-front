{"ast":null,"code":"import _defineProperty from \"D:/MyFile/WebCode/ocean-vis/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nimport { defineComponent, ref, computed, watch, nextTick, provide, reactive, onMounted, resolveComponent, openBlock, createElementBlock, normalizeClass, createElementVNode, normalizeStyle, createBlock, resolveDynamicComponent, withCtx, renderSlot, createCommentVNode } from 'vue';\nimport { isNumber, useResizeObserver, useEventListener } from '@vueuse/core';\nimport '../../../utils/index.mjs';\nimport '../../../tokens/index.mjs';\nimport '../../../hooks/index.mjs';\nimport Bar from './bar2.mjs';\nimport { scrollbarProps, scrollbarEmits } from './scrollbar.mjs';\nimport _export_sfc from '../../../_virtual/plugin-vue_export-helper.mjs';\nimport { useNamespace } from '../../../hooks/use-namespace/index.mjs';\nimport { addUnit } from '../../../utils/vue/style.mjs';\nimport { debugWarn } from '../../../utils/error.mjs';\nimport { scrollbarContextKey } from '../../../tokens/scrollbar.mjs';\n\nvar _sfc_main = defineComponent({\n  name: \"ElScrollbar\",\n  components: {\n    Bar: Bar\n  },\n  props: scrollbarProps,\n  emits: scrollbarEmits,\n  setup: function setup(props, _ref) {\n    var emit = _ref.emit;\n    var ns = useNamespace(\"scrollbar\");\n    var stopResizeObserver = void 0;\n    var stopResizeListener = void 0;\n    var scrollbar$ = ref();\n    var wrap$ = ref();\n    var resize$ = ref();\n    var sizeWidth = ref(\"0\");\n    var sizeHeight = ref(\"0\");\n    var barRef = ref();\n    var moveX = ref(0);\n    var moveY = ref(0);\n    var ratioY = ref(1);\n    var ratioX = ref(1);\n    var SCOPE = \"ElScrollbar\";\n    var GAP = 4;\n    var style = computed(function () {\n      var style2 = {};\n      if (props.height) style2.height = addUnit(props.height);\n      if (props.maxHeight) style2.maxHeight = addUnit(props.maxHeight);\n      return [props.wrapStyle, style2];\n    });\n\n    var handleScroll = function handleScroll() {\n      var _a;\n\n      if (wrap$.value) {\n        (_a = barRef.value) == null ? void 0 : _a.handleScroll(wrap$.value);\n        emit(\"scroll\", {\n          scrollTop: wrap$.value.scrollTop,\n          scrollLeft: wrap$.value.scrollLeft\n        });\n      }\n    };\n\n    var setScrollTop = function setScrollTop(value) {\n      if (!isNumber(value)) {\n        debugWarn(SCOPE, \"value must be a number\");\n        return;\n      }\n\n      wrap$.value.scrollTop = value;\n    };\n\n    var setScrollLeft = function setScrollLeft(value) {\n      if (!isNumber(value)) {\n        debugWarn(SCOPE, \"value must be a number\");\n        return;\n      }\n\n      wrap$.value.scrollLeft = value;\n    };\n\n    var update = function update() {\n      if (!wrap$.value) return;\n      var offsetHeight = wrap$.value.offsetHeight - GAP;\n      var offsetWidth = wrap$.value.offsetWidth - GAP;\n      var originalHeight = Math.pow(offsetHeight, 2) / wrap$.value.scrollHeight;\n      var originalWidth = Math.pow(offsetWidth, 2) / wrap$.value.scrollWidth;\n      var height = Math.max(originalHeight, props.minSize);\n      var width = Math.max(originalWidth, props.minSize);\n      ratioY.value = originalHeight / (offsetHeight - originalHeight) / (height / (offsetHeight - height));\n      ratioX.value = originalWidth / (offsetWidth - originalWidth) / (width / (offsetWidth - width));\n      sizeHeight.value = height + GAP < offsetHeight ? \"\".concat(height, \"px\") : \"\";\n      sizeWidth.value = width + GAP < offsetWidth ? \"\".concat(width, \"px\") : \"\";\n    };\n\n    watch(function () {\n      return props.noresize;\n    }, function (noresize) {\n      if (noresize) {\n        stopResizeObserver == null ? void 0 : stopResizeObserver();\n        stopResizeListener == null ? void 0 : stopResizeListener();\n      } else {\n        ;\n\n        var _useResizeObserver = useResizeObserver(resize$, update);\n\n        stopResizeObserver = _useResizeObserver.stop;\n        stopResizeListener = useEventListener(\"resize\", update);\n      }\n    }, {\n      immediate: true\n    });\n    watch(function () {\n      return [props.maxHeight, props.height];\n    }, function () {\n      if (!props.native) nextTick(function () {\n        var _a;\n\n        update();\n\n        if (wrap$.value) {\n          (_a = barRef.value) == null ? void 0 : _a.handleScroll(wrap$.value);\n        }\n      });\n    });\n    provide(scrollbarContextKey, reactive({\n      scrollbarElement: scrollbar$,\n      wrapElement: wrap$\n    }));\n    onMounted(function () {\n      if (!props.native) nextTick(function () {\n        return update();\n      });\n    });\n    return {\n      ns: ns,\n      scrollbar$: scrollbar$,\n      wrap$: wrap$,\n      resize$: resize$,\n      barRef: barRef,\n      moveX: moveX,\n      moveY: moveY,\n      ratioX: ratioX,\n      ratioY: ratioY,\n      sizeWidth: sizeWidth,\n      sizeHeight: sizeHeight,\n      style: style,\n      update: update,\n      handleScroll: handleScroll,\n      setScrollTop: setScrollTop,\n      setScrollLeft: setScrollLeft\n    };\n  }\n});\n\nfunction _sfc_render(_ctx, _cache, $props, $setup, $data, $options) {\n  var _component_bar = resolveComponent(\"bar\");\n\n  return openBlock(), createElementBlock(\"div\", {\n    ref: \"scrollbar$\",\n    class: normalizeClass(_ctx.ns.b())\n  }, [createElementVNode(\"div\", {\n    ref: \"wrap$\",\n    class: normalizeClass([_ctx.wrapClass, _ctx.ns.e(\"wrap\"), _defineProperty({}, _ctx.ns.em(\"wrap\", \"hidden-default\"), !_ctx.native)]),\n    style: normalizeStyle(_ctx.style),\n    onScroll: _cache[0] || (_cache[0] = function () {\n      return _ctx.handleScroll && _ctx.handleScroll.apply(_ctx, arguments);\n    })\n  }, [(openBlock(), createBlock(resolveDynamicComponent(_ctx.tag), {\n    ref: \"resize$\",\n    class: normalizeClass([_ctx.ns.e(\"view\"), _ctx.viewClass]),\n    style: normalizeStyle(_ctx.viewStyle)\n  }, {\n    default: withCtx(function () {\n      return [renderSlot(_ctx.$slots, \"default\")];\n    }),\n    _: 3\n  }, 8, [\"class\", \"style\"]))], 38), !_ctx.native ? (openBlock(), createBlock(_component_bar, {\n    key: 0,\n    ref: \"barRef\",\n    height: _ctx.sizeHeight,\n    width: _ctx.sizeWidth,\n    always: _ctx.always,\n    \"ratio-x\": _ctx.ratioX,\n    \"ratio-y\": _ctx.ratioY\n  }, null, 8, [\"height\", \"width\", \"always\", \"ratio-x\", \"ratio-y\"])) : createCommentVNode(\"v-if\", true)], 2);\n}\n\nvar Scrollbar = /* @__PURE__ */_export_sfc(_sfc_main, [[\"render\", _sfc_render]]);\n\nexport { Scrollbar as default };","map":{"version":3,"mappings":"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","names":["_sfc_main","defineComponent","name","components","Bar","props","scrollbarProps","emits","scrollbarEmits","setup","emit","ns","useNamespace","stopResizeObserver","stopResizeListener","scrollbar$","ref","wrap$","resize$","sizeWidth","sizeHeight","barRef","moveX","moveY","ratioY","ratioX","SCOPE","GAP","style","computed","style2","height","addUnit","maxHeight","wrapStyle","handleScroll","_a","scrollTop","scrollLeft","setScrollTop","debugWarn","setScrollLeft","update","offsetHeight","offsetWidth","originalHeight","originalWidth","scrollWidth","value","width","watch","useResizeObserver","stop","immediate","native","nextTick","provide","scrollbarElement","wrapElement","onMounted","$setup","class","createElementVNode","_ctx","openBlock","default","key","always"],"sources":["../../../../../../packages/components/scrollbar/src/scrollbar.vue"],"sourcesContent":["<template>\n  <div ref=\"scrollbar$\" :class=\"ns.b()\">\n    <div\n      ref=\"wrap$\"\n      :class=\"[\n        wrapClass,\n        ns.e('wrap'),\n        { [ns.em('wrap', 'hidden-default')]: !native },\n      ]\"\n      :style=\"style\"\n      @scroll=\"handleScroll\"\n    >\n      <component\n        :is=\"tag\"\n        ref=\"resize$\"\n        :class=\"[ns.e('view'), viewClass]\"\n        :style=\"viewStyle\"\n      >\n        <slot />\n      </component>\n    </div>\n    <template v-if=\"!native\">\n      <bar\n        ref=\"barRef\"\n        :height=\"sizeHeight\"\n        :width=\"sizeWidth\"\n        :always=\"always\"\n        :ratio-x=\"ratioX\"\n        :ratio-y=\"ratioY\"\n      ></bar>\n    </template>\n  </div>\n</template>\n<script lang=\"ts\">\nimport {\n  computed,\n  defineComponent,\n  nextTick,\n  onMounted,\n  provide,\n  ref,\n  watch,\n  reactive,\n} from 'vue'\nimport { useResizeObserver, useEventListener } from '@vueuse/core'\nimport { isNumber, debugWarn, addUnit } from '@element-plus/utils'\nimport { scrollbarContextKey } from '@element-plus/tokens'\nimport { useNamespace } from '@element-plus/hooks'\nimport Bar from './bar.vue'\n\nimport { scrollbarProps, scrollbarEmits } from './scrollbar'\nimport type { StyleValue, CSSProperties } from 'vue'\n\nexport default defineComponent({\n  name: 'ElScrollbar',\n  components: {\n    Bar,\n  },\n  props: scrollbarProps,\n  emits: scrollbarEmits,\n\n  setup(props, { emit }) {\n    const ns = useNamespace('scrollbar')\n\n    let stopResizeObserver: (() => void) | undefined = undefined\n    let stopResizeListener: (() => void) | undefined = undefined\n\n    const scrollbar$ = ref<HTMLDivElement>()\n    const wrap$ = ref<HTMLDivElement>()\n    const resize$ = ref<HTMLElement>()\n\n    const sizeWidth = ref('0')\n    const sizeHeight = ref('0')\n    const barRef = ref()\n    const moveX = ref(0)\n    const moveY = ref(0)\n    const ratioY = ref(1)\n    const ratioX = ref(1)\n    const SCOPE = 'ElScrollbar'\n    const GAP = 4 // top 2 + bottom 2 of bar instance\n\n    const style = computed<StyleValue>(() => {\n      const style: CSSProperties = {}\n      if (props.height) style.height = addUnit(props.height)\n      if (props.maxHeight) style.maxHeight = addUnit(props.maxHeight)\n      return [props.wrapStyle, style]\n    })\n\n    const handleScroll = () => {\n      if (wrap$.value) {\n        barRef.value?.handleScroll(wrap$.value)\n\n        emit('scroll', {\n          scrollTop: wrap$.value.scrollTop,\n          scrollLeft: wrap$.value.scrollLeft,\n        })\n      }\n    }\n\n    const setScrollTop = (value: number) => {\n      if (!isNumber(value)) {\n        debugWarn(SCOPE, 'value must be a number')\n        return\n      }\n      wrap$.value!.scrollTop = value\n    }\n\n    const setScrollLeft = (value: number) => {\n      if (!isNumber(value)) {\n        debugWarn(SCOPE, 'value must be a number')\n        return\n      }\n      wrap$.value!.scrollLeft = value\n    }\n\n    const update = () => {\n      if (!wrap$.value) return\n      const offsetHeight = wrap$.value.offsetHeight - GAP\n      const offsetWidth = wrap$.value.offsetWidth - GAP\n\n      const originalHeight = offsetHeight ** 2 / wrap$.value.scrollHeight\n      const originalWidth = offsetWidth ** 2 / wrap$.value.scrollWidth\n      const height = Math.max(originalHeight, props.minSize)\n      const width = Math.max(originalWidth, props.minSize)\n\n      ratioY.value =\n        originalHeight /\n        (offsetHeight - originalHeight) /\n        (height / (offsetHeight - height))\n      ratioX.value =\n        originalWidth /\n        (offsetWidth - originalWidth) /\n        (width / (offsetWidth - width))\n\n      sizeHeight.value = height + GAP < offsetHeight ? `${height}px` : ''\n      sizeWidth.value = width + GAP < offsetWidth ? `${width}px` : ''\n    }\n\n    watch(\n      () => props.noresize,\n      (noresize) => {\n        if (noresize) {\n          stopResizeObserver?.()\n          stopResizeListener?.()\n        } else {\n          ;({ stop: stopResizeObserver } = useResizeObserver(resize$, update))\n          stopResizeListener = useEventListener('resize', update)\n        }\n      },\n      { immediate: true }\n    )\n\n    watch(\n      () => [props.maxHeight, props.height],\n      () => {\n        if (!props.native)\n          nextTick(() => {\n            update()\n            if (wrap$.value) {\n              barRef.value?.handleScroll(wrap$.value)\n            }\n          })\n      }\n    )\n\n    provide(\n      scrollbarContextKey,\n      reactive({\n        scrollbarElement: scrollbar$,\n        wrapElement: wrap$,\n      })\n    )\n\n    onMounted(() => {\n      if (!props.native) nextTick(() => update())\n    })\n\n    return {\n      ns,\n      scrollbar$,\n      wrap$,\n      resize$,\n      barRef,\n      moveX,\n      moveY,\n      ratioX,\n      ratioY,\n      sizeWidth,\n      sizeHeight,\n      style,\n      update,\n      handleScroll,\n      setScrollTop,\n      setScrollLeft,\n    }\n  },\n})\n</script>\n"]},"metadata":{},"sourceType":"module"}