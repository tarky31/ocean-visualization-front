{"ast":null,"code":"import _defineProperty from \"D:/MyFile/WebCode/ocean-vis/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nimport _objectSpread from \"D:/MyFile/WebCode/ocean-vis/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport \"core-js/modules/es.number.constructor.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport { defineComponent, getCurrentInstance, reactive, inject, computed, onMounted, toRefs, onUnmounted, withDirectives, openBlock, createElementBlock, normalizeClass, normalizeStyle, vShow, createCommentVNode, renderSlot } from 'vue';\nimport '../../../utils/index.mjs';\nimport '../../../hooks/index.mjs';\nimport _export_sfc from '../../../_virtual/plugin-vue_export-helper.mjs';\nimport { useNamespace } from '../../../hooks/use-namespace/index.mjs';\nimport { debugWarn } from '../../../utils/error.mjs';\nvar CARD_SCALE = 0.83;\n\nvar _sfc_main = defineComponent({\n  name: \"ElCarouselItem\",\n  props: {\n    name: {\n      type: String,\n      default: \"\"\n    },\n    label: {\n      type: [String, Number],\n      default: \"\"\n    }\n  },\n  setup: function setup(props) {\n    var ns = useNamespace(\"carousel\");\n    var instance = getCurrentInstance();\n    var data = reactive({\n      hover: false,\n      translate: 0,\n      scale: 1,\n      active: false,\n      ready: false,\n      inStage: false,\n      animating: false\n    });\n    var injectCarouselScope = inject(\"injectCarouselScope\");\n    var parentDirection = computed(function () {\n      return injectCarouselScope.direction;\n    });\n    var itemStyle = computed(function () {\n      var translateType = parentDirection.value === \"vertical\" ? \"translateY\" : \"translateX\";\n      var value = \"\".concat(translateType, \"(\").concat(data.translate, \"px) scale(\").concat(data.scale, \")\");\n      var style = {\n        transform: value\n      };\n      return style;\n    });\n\n    function processIndex(index, activeIndex, length) {\n      if (activeIndex === 0 && index === length - 1) {\n        return -1;\n      } else if (activeIndex === length - 1 && index === 0) {\n        return length;\n      } else if (index < activeIndex - 1 && activeIndex - index >= length / 2) {\n        return length + 1;\n      } else if (index > activeIndex + 1 && index - activeIndex >= length / 2) {\n        return -2;\n      }\n\n      return index;\n    }\n\n    function calcCardTranslate(index, activeIndex) {\n      var _a;\n\n      var parentWidth = ((_a = injectCarouselScope.root.value) == null ? void 0 : _a.offsetWidth) || 0;\n\n      if (data.inStage) {\n        return parentWidth * ((2 - CARD_SCALE) * (index - activeIndex) + 1) / 4;\n      } else if (index < activeIndex) {\n        return -(1 + CARD_SCALE) * parentWidth / 4;\n      } else {\n        return (3 + CARD_SCALE) * parentWidth / 4;\n      }\n    }\n\n    function calcTranslate(index, activeIndex, isVertical) {\n      var _a, _b;\n\n      var distance = (isVertical ? (_a = injectCarouselScope.root.value) == null ? void 0 : _a.offsetHeight : (_b = injectCarouselScope.root.value) == null ? void 0 : _b.offsetWidth) || 0;\n      return distance * (index - activeIndex);\n    }\n\n    var translateItem = function translateItem(index, activeIndex, oldIndex) {\n      var parentType = injectCarouselScope.type;\n      var length = injectCarouselScope.items.value.length;\n\n      if (parentType !== \"card\" && oldIndex !== void 0) {\n        data.animating = index === activeIndex || index === oldIndex;\n      }\n\n      if (index !== activeIndex && length > 2 && injectCarouselScope.loop) {\n        index = processIndex(index, activeIndex, length);\n      }\n\n      if (parentType === \"card\") {\n        if (parentDirection.value === \"vertical\") {\n          debugWarn(\"Carousel\", \"vertical direction is not supported in card mode\");\n        }\n\n        data.inStage = Math.round(Math.abs(index - activeIndex)) <= 1;\n        data.active = index === activeIndex;\n        data.translate = calcCardTranslate(index, activeIndex);\n        data.scale = data.active ? 1 : CARD_SCALE;\n      } else {\n        data.active = index === activeIndex;\n        var isVertical = parentDirection.value === \"vertical\";\n        data.translate = calcTranslate(index, activeIndex, isVertical);\n      }\n\n      data.ready = true;\n    };\n\n    function handleItemClick() {\n      if (injectCarouselScope && injectCarouselScope.type === \"card\") {\n        var index = injectCarouselScope.items.value.map(function (d) {\n          return d.uid;\n        }).indexOf(instance.uid);\n        injectCarouselScope.setActiveItem(index);\n      }\n    }\n\n    onMounted(function () {\n      if (injectCarouselScope.addItem) {\n        injectCarouselScope.addItem(_objectSpread(_objectSpread(_objectSpread({\n          uid: instance.uid\n        }, props), toRefs(data)), {}, {\n          translateItem: translateItem\n        }));\n      }\n    });\n    onUnmounted(function () {\n      if (injectCarouselScope.removeItem) {\n        injectCarouselScope.removeItem(instance.uid);\n      }\n    });\n    return {\n      data: data,\n      itemStyle: itemStyle,\n      translateItem: translateItem,\n      type: injectCarouselScope.type,\n      handleItemClick: handleItemClick,\n      ns: ns\n    };\n  }\n});\n\nfunction _sfc_render(_ctx, _cache, $props, $setup, $data, $options) {\n  return withDirectives((openBlock(), createElementBlock(\"div\", {\n    class: normalizeClass([_ctx.ns.e(\"item\"), _ctx.ns.is(\"active\", _ctx.data.active), _ctx.ns.is(\"in-stage\", _ctx.data.inStage), _ctx.ns.is(\"hover\", _ctx.data.hover), _ctx.ns.is(\"animating\", _ctx.data.animating), _defineProperty({}, _ctx.ns.em(\"item\", \"card\"), _ctx.type === \"card\")]),\n    style: normalizeStyle(_ctx.itemStyle),\n    onClick: _cache[0] || (_cache[0] = function () {\n      return _ctx.handleItemClick && _ctx.handleItemClick.apply(_ctx, arguments);\n    })\n  }, [_ctx.type === \"card\" ? withDirectives((openBlock(), createElementBlock(\"div\", {\n    key: 0,\n    class: normalizeClass(_ctx.ns.e(\"mask\"))\n  }, null, 2)), [[vShow, !_ctx.data.active]]) : createCommentVNode(\"v-if\", true), renderSlot(_ctx.$slots, \"default\")], 6)), [[vShow, _ctx.data.ready]]);\n}\n\nvar CarouselItem = /* @__PURE__ */_export_sfc(_sfc_main, [[\"render\", _sfc_render]]);\n\nexport { CarouselItem as default };","map":{"version":3,"mappings":"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","names":["CARD_SCALE","_sfc_main","defineComponent","name","props","type","String","default","label","Number","setup","ns","useNamespace","instance","getCurrentInstance","data","reactive","hover","translate","scale","active","ready","inStage","animating","injectCarouselScope","inject","parentDirection","computed","direction","itemStyle","translateType","value","style","transform","index","activeIndex","length","oldIndex","debugWarn","Math","calcCardTranslate","onMounted","uid","toRefs","translateItem","onUnmounted","handleItemClick","class","_ctx","e","is","onClick","key","createCommentVNode"],"sources":["../../../../../../packages/components/carousel/src/item.vue"],"sourcesContent":["<template>\n  <div\n    v-show=\"data.ready\"\n    :class=\"[\n      ns.e('item'),\n      ns.is('active', data.active),\n      ns.is('in-stage', data.inStage),\n      ns.is('hover', data.hover),\n      ns.is('animating', data.animating),\n      { [ns.em('item', 'card')]: type === 'card' },\n    ]\"\n    :style=\"itemStyle\"\n    @click=\"handleItemClick\"\n  >\n    <div\n      v-if=\"type === 'card'\"\n      v-show=\"!data.active\"\n      :class=\"ns.e('mask')\"\n    ></div>\n    <slot></slot>\n  </div>\n</template>\n<script lang=\"ts\">\nimport {\n  defineComponent,\n  reactive,\n  onMounted,\n  inject,\n  computed,\n  toRefs,\n  getCurrentInstance,\n  onUnmounted,\n} from 'vue'\nimport { debugWarn } from '@element-plus/utils'\nimport { useNamespace } from '@element-plus/hooks'\nimport type { CSSProperties } from 'vue'\nimport type { InjectCarouselScope, ICarouselItemProps } from './carousel'\n\nconst CARD_SCALE = 0.83\nexport default defineComponent({\n  name: 'ElCarouselItem',\n  props: {\n    name: { type: String, default: '' },\n    label: {\n      type: [String, Number],\n      default: '',\n    },\n  },\n  setup(props: ICarouselItemProps) {\n    const ns = useNamespace('carousel')\n    // instance\n    const instance = getCurrentInstance()\n\n    // data\n    const data = reactive({\n      hover: false,\n      translate: 0,\n      scale: 1,\n      active: false,\n      ready: false,\n      inStage: false,\n      animating: false,\n    })\n\n    // inject\n    const injectCarouselScope: InjectCarouselScope = inject(\n      'injectCarouselScope'\n    )\n\n    // computed\n    const parentDirection = computed(() => {\n      return injectCarouselScope.direction\n    })\n\n    const itemStyle = computed(() => {\n      const translateType =\n        parentDirection.value === 'vertical' ? 'translateY' : 'translateX'\n      const value = `${translateType}(${data.translate}px) scale(${data.scale})`\n      const style: CSSProperties = {\n        transform: value,\n      }\n      return style\n    })\n\n    // methods\n\n    function processIndex(index, activeIndex, length) {\n      if (activeIndex === 0 && index === length - 1) {\n        return -1\n      } else if (activeIndex === length - 1 && index === 0) {\n        return length\n      } else if (index < activeIndex - 1 && activeIndex - index >= length / 2) {\n        return length + 1\n      } else if (index > activeIndex + 1 && index - activeIndex >= length / 2) {\n        return -2\n      }\n      return index\n    }\n\n    function calcCardTranslate(index, activeIndex) {\n      const parentWidth = injectCarouselScope.root.value?.offsetWidth || 0\n      if (data.inStage) {\n        return (\n          (parentWidth * ((2 - CARD_SCALE) * (index - activeIndex) + 1)) / 4\n        )\n      } else if (index < activeIndex) {\n        return (-(1 + CARD_SCALE) * parentWidth) / 4\n      } else {\n        return ((3 + CARD_SCALE) * parentWidth) / 4\n      }\n    }\n\n    function calcTranslate(index, activeIndex, isVertical) {\n      const distance =\n        (isVertical\n          ? injectCarouselScope.root.value?.offsetHeight\n          : injectCarouselScope.root.value?.offsetWidth) || 0\n      return distance * (index - activeIndex)\n    }\n\n    const translateItem = (\n      index: number,\n      activeIndex: number,\n      oldIndex: number\n    ) => {\n      const parentType = injectCarouselScope.type\n      const length = injectCarouselScope.items.value.length\n      if (parentType !== 'card' && oldIndex !== undefined) {\n        data.animating = index === activeIndex || index === oldIndex\n      }\n      if (index !== activeIndex && length > 2 && injectCarouselScope.loop) {\n        index = processIndex(index, activeIndex, length)\n      }\n      if (parentType === 'card') {\n        if (parentDirection.value === 'vertical') {\n          debugWarn(\n            'Carousel',\n            'vertical direction is not supported in card mode'\n          )\n        }\n        data.inStage = Math.round(Math.abs(index - activeIndex)) <= 1\n        data.active = index === activeIndex\n        data.translate = calcCardTranslate(index, activeIndex)\n        data.scale = data.active ? 1 : CARD_SCALE\n      } else {\n        data.active = index === activeIndex\n        const isVertical = parentDirection.value === 'vertical'\n        data.translate = calcTranslate(index, activeIndex, isVertical)\n      }\n      data.ready = true\n    }\n\n    function handleItemClick() {\n      if (injectCarouselScope && injectCarouselScope.type === 'card') {\n        const index = injectCarouselScope.items.value\n          .map((d) => d.uid)\n          .indexOf(instance.uid)\n        injectCarouselScope.setActiveItem(index)\n      }\n    }\n\n    // lifecycle\n    onMounted(() => {\n      if (injectCarouselScope.addItem) {\n        injectCarouselScope.addItem({\n          uid: instance.uid,\n          ...props,\n          ...toRefs(data),\n          translateItem,\n        })\n      }\n    })\n\n    onUnmounted(() => {\n      if (injectCarouselScope.removeItem) {\n        injectCarouselScope.removeItem(instance.uid)\n      }\n    })\n\n    return {\n      data,\n      itemStyle,\n      translateItem,\n      type: injectCarouselScope.type,\n      handleItemClick,\n      ns,\n    }\n  },\n})\n</script>\n"]},"metadata":{},"sourceType":"module"}