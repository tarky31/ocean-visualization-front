{"ast":null,"code":"import \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.number.to-fixed.js\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport \"ol/ol.css\";\nimport Map from \"ol/Map\";\nimport View from \"ol/View\";\nimport TileLayer from \"ol/layer/Tile\";\nimport XYZ from \"ol/source/XYZ\";\nimport ScaleLine from \"ol/control/ScaleLine\";\nimport MousePosition from \"ol/control/MousePosition\";\nimport { fromLonLat } from \"ol/proj\"; // import Control from 'ol/control';\n// import {Control, defaults as defaultControls} from 'ol/control';\n\nimport { OverviewMap, defaults as defaultControls } from \"ol/control\";\nimport { format } from \"ol/coordinate\";\nexport default {\n  name: 'Map',\n  mounted: function mounted() {\n    this.initMap();\n  },\n  data: function data() {\n    return {\n      map: null\n    };\n  },\n  methods: {\n    initMap: function initMap() {\n      // let mylayers = [], addedLayer;  // 存影像服务, 加载的影像名称\n      var tdtLayer = new TileLayer({\n        title: \"谷歌矢量地图服务\",\n        source: new XYZ({\n          // arcgis server\n          url: 'http://map.geoq.cn/arcgis/rest/services/ChinaOnlineStreetWarm/MapServer/tile/{z}/{y}/{x}'\n        })\n      });\n      this.map = new Map({\n        target: 'map1',\n        // 关联到对应的div容器\n        layers: [tdtLayer],\n        view: new View({\n          // 地图视图\n          projection: 'EPSG:4326',\n          center: [113, 12],\n          zoom: 4\n        }),\n        controls: defaultControls().extend([new ScaleLine({\n          //设置度量单位为米\n          units: 'metric',\n          target: 'scalebar',\n          className: 'ol-scale-line1'\n        }), new MousePosition({\n          coordinateFormat: function coordinateFormat(coordinate) {\n            return format(coordinate, '经度:{x} 纬度:{y}', 2);\n          },\n          projection: 'EPSG:4326',\n          className: 'custom-mouse-position',\n          target: document.getElementById('lnglat1'),\n          undefinedHTML: '&nbsp;'\n        })])\n      });\n      this.map.on(\"moveend\", function (e) {\n        var value = \"Scale 1 : \" + document.getElementsByClassName(\"ol-scale-line1-inner\")[0].innerHTML;\n        document.getElementById(\"mapfooter1\").getElementsByClassName(\"scale\")[0].innerHTML = value; // $(\"#mapfooter1 .scale\").html(\"Scale 1 : \" + $(\".ol-scale-line1-inner\").html())\n\n        var extent = this.map.getView().calculateExtent();\n        var geLng = (extent[2] - extent[0]) / 5;\n        var geLat = (extent[3] - extent[1]) / 5;\n        var su = \"\",\n            heng = \"\";\n\n        for (var i = 0; i < 5; i++) {\n          su += \"<div class=\\\"kedu1\\\"><span>\".concat((geLat * i + extent[1]).toFixed(1), \"</span></div>\");\n          heng += \"<div class=\\\"kedu2\\\"><span>\".concat((geLng * i + extent[0]).toFixed(1), \"</span></div>\");\n        }\n\n        document.getElementById(\"mapPanel1\").getElementsByClassName(\"left\")[0].innerHTML = su; // $(\"#mapPanel1 .left\").html(su);\n\n        document.getElementsByClassName(\"top1\")[0].innerHTML = heng; // $(\".top1\").html(heng)\n      }); // this.map.on('singleclick', function (evt) {\n      //   if (addedLayer === '') {\n      //     alert('请先加载影像！')\n      //     return;\n      //   }\n      //   let coor = evt.coordinate;\n      //   let bbox = (coor[0] - 2) + \",\" + (coor[1] - 2) + \",\" + (coor[0] + 2) + \",\" + (coor[1] + 2)\n      //   $.get(`/mygeoserver/geoserver/tif2022/wms?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetFeatureInfo&FORMAT=image%2Fjpeg\n      //           &TRANSPARENT=true&QUERY_LAYERS=${addedLayer}&LAYERS=${addedLayer}&exceptions=application%2Fvnd.ogc.se_inimage&INFO_FORMAT=application%2Fjson\n      //           &FEATURE_COUNT=50&X=50&Y=50&SRS=EPSG%3A404000&STYLES=&WIDTH=101&HEIGHT=101&BBOX=${bbox}`, (e) => {\n      //   let result = \"无\"\n      //     if (e.features.length !== 0) {\n      //       result = e.features[0].properties.GRAY_INDEX.toFixed(4)\n      //     }\n      //     document.getElementById(\"mapfooter1\").getElementsByClassName(\"mapval\")[0].innerHTML=result;\n      //     // $(\"#mapfooter1 .mapval\").html(result)\n      //   })\n      // });\n    }\n  }\n};","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qC,CACA;AACA;;AACA;AACA;AACA;AACAA,aADA;AAEAC,SAFA,qBAEA;AACA;AACA,GAJA;AAKAC,MALA,kBAKA;AACA;AACAC;AADA;AAGA,GATA;AAUAC;AACAC;AACA;AACA;AACAC,yBADA;AAEAC;AACA;AACAC;AAFA;AAFA;AAOA;AACAC,sBADA;AACA;AACAC,iBACAC,QADA,CAFA;AAKAC;AAAA;AACAC,iCADA;AAEAC,2BAFA;AAGAC;AAHA,UALA;AAUAC,4CACA;AACA;AACAC,yBAFA;AAGAR,4BAHA;AAIAS;AAJA,UADA,EAOA;AACAC;AACA;AACA,WAHA;AAIAN,iCAJA;AAKAK,4CALA;AAMAT,oDANA;AAOAW;AAPA,UAPA;AAVA;AA4BA;AACA;AACAC,mGAFA,CAGA;;AACA;AACA;AACA;AACA;AAAA;;AACA;AACAC;AACAC;AACA;;AACAF,8FAZA,CAaA;;AACAA,oEAdA,CAeA;AACA,OAhBA,EArCA,CAsDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAzEA;AAVA","names":["name","mounted","data","map","methods","initMap","title","source","url","target","layers","tdtLayer","view","projection","center","zoom","controls","units","className","coordinateFormat","undefinedHTML","document","su","heng"],"sourceRoot":"views","sources":["Map.vue"],"sourcesContent":["<template>\r\n<div style=\"height:100%\">\r\n<div id=\"maptitle1\">标题</div>\r\n    <div id=\"mapPanel1\">\r\n    <div class=\"titlelng\"\r\n      style=\"text-align: center;font-size: 12px;font-weight: bold;writing-mode: tb;transform: rotate(180deg);\">\r\n      Latitude(°)</div>\r\n    <div class=\"left\" ref=\"left\"></div>\r\n    <div id=\"map1\"></div>\r\n    <div class=\"right\">\r\n      <img id=\"legend1\" src=\"\" style=\"height: 100%;\" />\r\n    </div>\r\n  </div>\r\n  <div class=\"top1\"></div>\r\n  <div class=\"titlelng\" style=\"text-align: center;font-size: 12px;font-weight: bold;\">Longitude(°)</div>\r\n  <div id=\"mapfooter1\">\r\n    <div class=\"scale\" ref='scale'></div>\r\n    <div class=\"mapval\" ref='mapval'>无</div>\r\n    <div class=\"lnglat\" id=\"lnglat1\" ref='lnglat1'></div>\r\n  </div>\r\n</div>\r\n    \r\n</template>\r\n\r\n<style>\r\n  #maptitle,#maptitle1,#maptitle2,#maptitle3,#maptitle4,#maptitle5{\r\n    height: 32px;\r\n    line-height: 32px;\r\n    font-weight: bold;\r\n    font-size: 12px;\r\n    padding-left:10%;\r\n}\r\n\r\n#mapfooter,#mapfooter1,#mapfooter2,#mapfooter3,#mapfooter4,#mapfooter5{\r\n    height: 25px;\r\n    display: flex;\r\n    justify-content: space-around;\r\n    align-items: center;\r\n    font-size: 12px;\r\n}\r\n.top,.top1,.top2,.top3,.top4,.top5{\r\n    display: flex;\r\n    flex-direction: row;\r\n    align-items: flex-start;\r\n    justify-content: flex-start;\r\n    padding-left: 10%;\r\n    height: 25px;\r\n    font-size: 12px;\r\n}\r\n.top .kedu2,.top1 .kedu2,.top2 .kedu2,.top3 .kedu2,.top4 .kedu2,.top5 .kedu2{\r\n    width: 20%;\r\n    border-left: 1px solid #333;\r\n    height: 4px;\r\n}\r\n\r\n.top .kedu2 span,.top1 .kedu2 span,.top2 .kedu2 span,.top3 .kedu2 span,.top4 .kedu2 span,.top5 .kedu2 span{\r\n    position: relative;\r\n    line-height: 30px;\r\n    margin-left: -10px;\r\n}\r\n\r\n#mapPanel,#mapPanel1,#mapPanel2,#mapPanel3,#mapPanel4,#mapPanel5{\r\n    height: calc(100% - 100px);\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n}\r\n\r\n#mapPanel .left,#mapPanel1 .left,#mapPanel2 .left,#mapPanel3 .left,#mapPanel4 .left,#mapPanel5 .left{\r\n    width: 10%;\r\n    display: flex;\r\n    flex-direction: column-reverse;\r\n    height: 100%;\r\n    justify-content: flex-start;\r\n    align-items: flex-end;\r\n    font-size: 12px;\r\n}\r\n\r\n#mapPanel .left .kedu1,#mapPanel1 .left .kedu1,#mapPanel2 .left .kedu1,#mapPanel3 .left .kedu1,#mapPanel4 .left .kedu1,#mapPanel5 .left .kedu1{\r\n    width: 10%;\r\n    height: 20%;\r\n    border-bottom: 1px solid #333;\r\n}\r\n\r\n#mapPanel .left .kedu1 span,#mapPanel1 .left .kedu1 span,#mapPanel2 .left .kedu1 span,#mapPanel3 .left .kedu1 span,#mapPanel4 .left .kedu1 span,#mapPanel5 .left .kedu1 span{\r\n    position: relative;\r\n    margin-left: -25px;\r\n    top: 100%;\r\n}\r\n\r\n#mapPanel .right,#mapPanel1 .right,#mapPanel2 .right,#mapPanel3 .right,#mapPanel4 .right,#mapPanel5 .right{\r\n    width: 5%;\r\n    height: 100%;\r\n}\r\n\r\n#map,#map1,#map2,#map3,#map4,#map5{\r\n    height: 100%;\r\n    width: 80%;\r\n    border-left: solid 1px black;\r\n    border-bottom: solid 1px black;\r\n}\r\n\r\n.ol-scale-line,.ol-scale-line1,.ol-scale-line2,.ol-scale-line3,.ol-scale-line4,.ol-scale-line5{\r\n    display: none !important;\r\n}\r\n</style>\r\n\r\n<script>\r\nimport \"ol/ol.css\";\r\nimport Map from \"ol/Map\";\r\nimport View from \"ol/View\";\r\nimport TileLayer from \"ol/layer/Tile\";\r\nimport XYZ from \"ol/source/XYZ\";\r\nimport ScaleLine from \"ol/control/ScaleLine\";\r\nimport MousePosition from \"ol/control/MousePosition\"\r\nimport { fromLonLat } from \"ol/proj\";\r\n// import Control from 'ol/control';\r\n// import {Control, defaults as defaultControls} from 'ol/control';\r\nimport {OverviewMap, defaults as defaultControls } from \"ol/control\";\r\nimport {format} from \"ol/coordinate\";\r\nexport default {\r\n    name:'Map',\r\n    mounted() {\r\n    this.initMap();\r\n  },\r\n  data(){\r\n    return{\r\n      map:null\r\n    };\r\n  },\r\n    methods:{\r\n      initMap: function(){\r\n       // let mylayers = [], addedLayer;  // 存影像服务, 加载的影像名称\r\n        var tdtLayer = new TileLayer({\r\n          title: \"谷歌矢量地图服务\",\r\n          source: new XYZ({\r\n            // arcgis server\r\n            url: 'http://map.geoq.cn/arcgis/rest/services/ChinaOnlineStreetWarm/MapServer/tile/{z}/{y}/{x}'\r\n          })\r\n        });\r\n      this.map = new Map({\r\n        target: 'map1',                          // 关联到对应的div容器\r\n        layers: [\r\n          tdtLayer\r\n        ],\r\n        view: new View({                     // 地图视图\r\n          projection: 'EPSG:4326',\r\n          center: [113, 12],\r\n          zoom: 4\r\n        }),\r\n        controls:  defaultControls().extend([\r\n          new ScaleLine({\r\n            //设置度量单位为米\r\n            units: 'metric',\r\n            target: 'scalebar',\r\n            className: 'ol-scale-line1'\r\n          }), \r\n          new MousePosition({\r\n            coordinateFormat: function (coordinate) {\r\n              return format(coordinate, '经度:{x} 纬度:{y}', 2);\r\n            },\r\n            projection: 'EPSG:4326',\r\n            className: 'custom-mouse-position',\r\n            target: document.getElementById('lnglat1'),\r\n            undefinedHTML: '&nbsp;'\r\n          })\r\n        ])\r\n      })\r\n    this.map.on(\"moveend\", function (e) {\r\n       let value=\"Scale 1 : \"+document.getElementsByClassName(\"ol-scale-line1-inner\")[0].innerHTML;\r\n       document.getElementById(\"mapfooter1\").getElementsByClassName(\"scale\")[0].innerHTML=value;\r\n    // $(\"#mapfooter1 .scale\").html(\"Scale 1 : \" + $(\".ol-scale-line1-inner\").html())\r\n      let extent = this.map.getView().calculateExtent()\r\n      let geLng = (extent[2] - extent[0]) / 5\r\n      let geLat = (extent[3] - extent[1]) / 5\r\n      let su = ``, heng = ``;\r\n      for (let i = 0; i < 5; i++) {\r\n        su += `<div class=\"kedu1\"><span>${(geLat * i + extent[1]).toFixed(1)}</span></div>`\r\n        heng += `<div class=\"kedu2\"><span>${(geLng * i + extent[0]).toFixed(1)}</span></div>`\r\n      }\r\n      document.getElementById(\"mapPanel1\").getElementsByClassName(\"left\")[0].innerHTML=su;\r\n      // $(\"#mapPanel1 .left\").html(su);\r\n      document.getElementsByClassName(\"top1\")[0].innerHTML=heng;\r\n      // $(\".top1\").html(heng)\r\n    })\r\n    // this.map.on('singleclick', function (evt) {\r\n    //   if (addedLayer === '') {\r\n    //     alert('请先加载影像！')\r\n    //     return;\r\n    //   }\r\n    //   let coor = evt.coordinate;\r\n    //   let bbox = (coor[0] - 2) + \",\" + (coor[1] - 2) + \",\" + (coor[0] + 2) + \",\" + (coor[1] + 2)\r\n    //   $.get(`/mygeoserver/geoserver/tif2022/wms?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetFeatureInfo&FORMAT=image%2Fjpeg\r\n    //           &TRANSPARENT=true&QUERY_LAYERS=${addedLayer}&LAYERS=${addedLayer}&exceptions=application%2Fvnd.ogc.se_inimage&INFO_FORMAT=application%2Fjson\r\n    //           &FEATURE_COUNT=50&X=50&Y=50&SRS=EPSG%3A404000&STYLES=&WIDTH=101&HEIGHT=101&BBOX=${bbox}`, (e) => {\r\n    //   let result = \"无\"\r\n    //     if (e.features.length !== 0) {\r\n    //       result = e.features[0].properties.GRAY_INDEX.toFixed(4)\r\n    //     }\r\n    //     document.getElementById(\"mapfooter1\").getElementsByClassName(\"mapval\")[0].innerHTML=result;\r\n    //     // $(\"#mapfooter1 .mapval\").html(result)\r\n    //   })\r\n    // });\r\n        },\r\n    }\r\n}\r\n</script>"]},"metadata":{},"sourceType":"module"}